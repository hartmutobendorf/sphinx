Implemented caching and figure support.