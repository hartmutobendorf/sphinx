# Phase 2: Configuration - Plan

**Objective**: Implement configuration options for D2 theme, fonts, and execution.

## Steps

1.  **Update `setup` in `__init__.py`**
    *   [ ] Verify `d2_command` exists and is maintained (CONF-01).
    *   [ ] Add `d2_theme` configuration option (default: `0`).
    *   [ ] Add `d2_font` configuration option (default: `None`).
    *   [ ] Add `d2_mono_font` configuration option (default: `None`).

2.  **Update `D2Directive`**
    *   [ ] Add `theme` to `option_spec`.
    *   [ ] Pass `theme` option to the node options in `run`.

3.  **Refactor `html_visit_d2`**
    *   [ ] Retrieve `d2_command` from config (CONF-01).
    *   [ ] Determine theme logic: Use `node.get('theme')` if present, otherwise fall back to `config.d2_theme`, finally default to `0`.
    *   [ ] Construct the command line arguments:
        *   Include `--theme` with the calculated theme.
        *   Include `--font-regular` if `config.d2_font` is set.
        *   Include `--font-mono` if `config.d2_mono_font` is set.
    *   [ ] Execute the D2 command with the updated arguments.
